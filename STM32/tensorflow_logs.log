tf.Tensor(
[[ 2.        2.       11.313708 22.627417]
 [ 2.        2.       14.254379 28.508759]
 [ 2.        2.       16.       16.      ]
 ...
 [96.       92.       40.317474 40.317474]
 [96.       92.       39.191837 26.12789 ]
 [96.       92.       49.37862  32.91908 ]], shape=(5760, 4), dtype=float32)
cls_ids tf.Tensor([1. 1. 1. 1.], shape=(4,), dtype=float32)



boxes1:  tf.Tensor(
[[ 2.        2.       11.313708 22.627417]
 [ 2.        2.       14.254379 28.508759]
 [ 2.        2.       16.       16.      ]
 ...
 [96.       92.       40.317474 40.317474]
 [96.       92.       39.191837 26.12789 ]
 [96.       92.       49.37862  32.91908 ]], shape=(5760, 4), dtype=float32)
boxes1_corners:  tf.Tensor(
[[ -3.6568542  -9.313708    7.656854   13.313708 ]
 [ -5.1271896 -12.254379    9.12719    16.25438  ]
 [ -6.         -6.         10.         10.       ]
 ...
 [ 75.84126    71.84126   116.15874   112.15874  ]
 [ 76.40408    78.93606   115.59592   105.06394  ]
 [ 71.31069    75.54046   120.68931   108.45954  ]], shape=(5760, 4), dtype=float32)
boxes2:  [[ 46.  78.  28.  36.]
 [ 16.  16.  32.  32.]
 [ 76.  72.  32.  40.]
 [116.  80.  24.  32.]]
boxes2_corners:  tf.Tensor(
[[ 32.  60.  60.  96.]
 [  0.   0.  32.  32.]
 [ 60.  52.  92.  92.]
 [104.  64. 128.  96.]], shape=(4, 4), dtype=float32)
lu:  tf.Tensor(
[[[ 32.       60.     ]
  [  0.        0.     ]
  [ 60.       52.     ]
  [104.       64.     ]]

 [[ 32.       60.     ]
  [  0.        0.     ]
  [ 60.       52.     ]
  [104.       64.     ]]

 [[ 32.       60.     ]
  [  0.        0.     ]
  [ 60.       52.     ]
  [104.       64.     ]]

 ...

 [[ 75.84126  71.84126]
  [ 75.84126  71.84126]
  [ 75.84126  71.84126]
  [104.       71.84126]]

 [[ 76.40408  78.93606]
  [ 76.40408  78.93606]
  [ 76.40408  78.93606]
  [104.       78.93606]]

 [[ 71.31069  75.54046]
  [ 71.31069  75.54046]
  [ 71.31069  75.54046]
  [104.       75.54046]]], shape=(5760, 4, 2), dtype=float32)
rd:  tf.Tensor(
[[[  7.656854  13.313708]
  [  7.656854  13.313708]
  [  7.656854  13.313708]
  [  7.656854  13.313708]]

 [[  9.12719   16.25438 ]
  [  9.12719   16.25438 ]
  [  9.12719   16.25438 ]
  [  9.12719   16.25438 ]]

 [[ 10.        10.      ]
  [ 10.        10.      ]
  [ 10.        10.      ]
  [ 10.        10.      ]]

 ...

 [[ 60.        96.      ]
  [ 32.        32.      ]
  [ 92.        92.      ]
  [116.15874   96.      ]]

 [[ 60.        96.      ]
  [ 32.        32.      ]
  [ 92.        92.      ]
  [115.59592   96.      ]]

 [[ 60.        96.      ]
  [ 32.        32.      ]
  [ 92.        92.      ]
  [120.68931   96.      ]]], shape=(5760, 4, 2), dtype=float32)
intersection:  tf.Tensor(
[[[ 0.        0.      ]
  [ 7.656854 13.313708]
  [ 0.        0.      ]
  [ 0.        0.      ]]

 [[ 0.        0.      ]
  [ 9.12719  16.25438 ]
  [ 0.        0.      ]
  [ 0.        0.      ]]

 [[ 0.        0.      ]
  [10.       10.      ]
  [ 0.        0.      ]
  [ 0.        0.      ]]

 ...

 [[ 0.       24.158737]
  [ 0.        0.      ]
  [16.158737 20.158737]
  [12.158737 24.158737]]

 [[ 0.       17.063942]
  [ 0.        0.      ]
  [15.595917 13.063942]
  [11.595917 17.063942]]

 [[ 0.       20.459541]
  [ 0.        0.      ]
  [20.689308 16.459541]
  [16.689308 20.459541]]], shape=(5760, 4, 2), dtype=float32)
intersection_area:  tf.Tensor(
[[  0.       101.941124   0.         0.      ]
 [  0.       148.3568     0.         0.      ]
 [  0.       100.         0.         0.      ]
 ...
 [  0.         0.       325.73975  293.73975 ]
 [  0.         0.       203.74416  197.87206 ]
 [  0.         0.       340.53653  341.4556  ]], shape=(5760, 4), dtype=float32)
union_area:  tf.Tensor(
[[1264.     1178.0588 1536.     1024.    ]
 [1414.3746 1282.0178 1686.3746 1174.3746]
 [1264.     1180.     1536.     1024.    ]
 ...
 [2633.4988 2649.4988 2579.759  2099.759 ]
 [2032.     2048.     2100.2559 1594.1279]
 [2633.4985 2649.4985 2564.962  2052.043 ]], shape=(5760, 4), dtype=float32)
iou_matrix:   tf.Tensor(
[[0.         0.08653314 0.         0.        ]
 [0.         0.11572132 0.         0.        ]
 [0.         0.08474576 0.         0.        ]
 ...
 [0.         0.         0.12626751 0.13989212]
 [0.         0.         0.0970092  0.12412558]
 [0.         0.         0.13276476 0.16639788]], shape=(5760, 4), dtype=float32)
max_iou:   tf.Tensor([0.08653314 0.11572132 0.08474576 ... 0.13989212 0.12412558 0.16639788], shape=(5760,), dtype=float32)


matched_gt_idx:   tf.Tensor([1 1 1 ... 3 3 3], shape=(5760,), dtype=int64)




positive_mask:   tf.Tensor([False False False ... False False False], shape=(5760,), dtype=bool)
negative_mask:   tf.Tensor([ True  True  True ...  True  True  True], shape=(5760,), dtype=bool)
ignore_mask:   tf.Tensor([False False False ... False False False], shape=(5760,), dtype=bool)



matched_gt_idx:   tf.Tensor([1 1 1 ... 3 3 3], shape=(5760,), dtype=int64)
positive_mask:   tf.Tensor([0. 0. 0. ... 0. 0. 0.], shape=(5760,), dtype=float32)
ignore_mask:   tf.Tensor([0. 0. 0. ... 0. 0. 0.], shape=(5760,), dtype=float32)


[[ 46.  78.  28.  36.]
 [ 16.  16.  32.  32.]
 [ 76.  72.  32.  40.]
 [116.  80.  24.  32.]]

matched_gt_boxes:   tf.Tensor(
[[ 16.  16.  32.  32.]
 [ 16.  16.  32.  32.]
 [ 16.  16.  32.  32.]
 ...
 [116.  80.  24.  32.]
 [116.  80.  24.  32.]
 [116.  80.  24.  32.]], shape=(5760, 4), dtype=float32)


box_target:   tf.Tensor(
[[ 1.2374369   0.61871845  1.0397208   0.34657356]
 [ 0.9821543   0.49107715  0.8086717   0.11552452]
 [ 0.875       0.875       0.6931472   0.6931472 ]
 ...
 [ 0.49606282 -0.2976377  -0.5187311  -0.23104908]
 [ 0.51031035 -0.45927936 -0.49041468  0.2027326 ]
 [ 0.4050336  -0.36453024 -0.7214637  -0.02831651]], shape=(5760, 4), dtype=float32)
box_target:   tf.Tensor(
[[12.374369    6.1871843   5.1986036   1.7328678 ]
 [ 9.821543    4.9107714   4.0433583   0.5776226 ]
 [ 8.75        8.75        3.465736    3.465736  ]
 ...
 [ 4.960628   -2.976377   -2.5936556  -1.1552453 ]
 [ 5.1031036  -4.5927935  -2.4520733   1.0136629 ]
 [ 4.050336   -3.6453023  -3.6073184  -0.14158253]], shape=(5760, 4), dtype=float32)
box_target:   tf.Tensor(
[[12.374369    6.1871843   5.1986036   1.7328678 ]
 [ 9.821543    4.9107714   4.0433583   0.5776226 ]
 [ 8.75        8.75        3.465736    3.465736  ]
 ...
 [ 4.960628   -2.976377   -2.5936556  -1.1552453 ]
 [ 5.1031036  -4.5927935  -2.4520733   1.0136629 ]
 [ 4.050336   -3.6453023  -3.6073184  -0.14158253]], shape=(5760, 4), dtype=float32)



 
matched_gt_cls_ids:   tf.Tensor([1. 1. 1. ... 1. 1. 1.], shape=(5760,), dtype=float32)
cls_target:   tf.Tensor([-1. -1. -1. ... -1. -1. -1.], shape=(5760,), dtype=float32)
cls_target:   tf.Tensor([-1. -1. -1. ... -1. -1. -1.], shape=(5760,), dtype=float32)
cls_target:   tf.Tensor(
[[-1.]
 [-1.]
 [-1.]
 ...
 [-1.]
 [-1.]
 [-1.]], shape=(5760, 1), dtype=float32)
label:   tf.Tensor(
[[12.374369    6.1871843   5.1986036   1.7328678  -1.        ]
 [ 9.821543    4.9107714   4.0433583   0.5776226  -1.        ]
 [ 8.75        8.75        3.465736    3.465736   -1.        ]
 ...
 [ 4.960628   -2.976377   -2.5936556  -1.1552453  -1.        ]
 [ 5.1031036  -4.5927935  -2.4520733   1.0136629  -1.        ]
 [ 4.050336   -3.6453023  -3.6073184  -0.14158253 -1.        ]], shape=(5760, 5), dtype=float32)
label:   tf.Tensor(
[[12.374369    6.1871843   5.1986036   1.7328678  -1.        ]
 [ 9.821543    4.9107714   4.0433583   0.5776226  -1.        ]
 [ 8.75        8.75        3.465736    3.465736   -1.        ]
 ...
 [ 4.960628   -2.976377   -2.5936556  -1.1552453  -1.        ]
 [ 5.1031036  -4.5927935  -2.4520733   1.0136629  -1.        ]
 [ 4.050336   -3.6453023  -3.6073184  -0.14158253 -1.        ]], shape=(5760, 5), dtype=float32)
(1, 96, 128, 1) (1, 4, 4) (1, 4)
images_shape:   tf.Tensor([  1  96 128   1], shape=(4,), dtype=int32)
batch_size:   tf.Tensor(1, shape=(), dtype=int32)
labels:   <tensorflow.python.ops.tensor_array_ops.TensorArray object at 0x7fe3f83442b0>
anchor_boxes  :  tf.Tensor(
[[ 2.        2.       11.313708 22.627417]
 [ 2.        2.       14.254379 28.508759]
 [ 2.        2.       16.       16.      ]
 ...
 [96.       92.       40.317474 40.317474]
 [96.       92.       39.191837 26.12789 ]
 [96.       92.       49.37862  32.91908 ]], shape=(5760, 4), dtype=float32)
cls_ids 